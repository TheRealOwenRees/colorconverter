{"version":3,"file":"conversions.js","names":["_utilities","require","referenceWhiteConstants","x","y","z","toRgbBase","colorObj","format","rgbToNormalizedRgb","value","hexToNormalizedRgb","hexToRgb","hslToRgbNormalized","hsvToRgbNormalized","lab","lchToLab","xyz","labToXyz","xyzToRgbNormalized","oklab","lRGB","okLabToLinearRbg","lRgbToNormalizedRgb","r","undefined","g","b","a","hexColor","rgb","rgbNormalizedToRgb","Math","round","rgbNormalizedToRgbPercent","lrgbToRgb","lrgb","Error","fn","c","abs","pow","rgbToHex","binaryRgb","toString","padStart","rgbaToHex8","rgba","aHex","convertDecimalToHex","rgbNormalizedToHsl","max","min","h","s","l","diff","rgbNormalizedToHsv","v","diffc","rr","gg","bb","hsl","hue2rgb","p","q","t","hsv","i","floor","f","mod","hex","expandHex","parseInt","replace","rgbNormalizedToCmy","m","cmyToCmyk","cmy","k","xyzToLab","labToLch","atan2","PI","sqrt","lch","hr","cos","sin","referenceWhite","y2","x2","z2","rgbToXyz","M1","M2","invM1","invM2","xyzToOklab","L","cbrt","M","S","okLabToXyz","lRgb","findClosestColor","namedColorsRgb","minDistance","Infinity","closestColor","lab1","color","lab2","distance","labDeltaE"],"sources":["../../../src/utils/conversions.ts"],"sourcesContent":["/*\n  Color conversion functions. 'Normalized' means 0-1 range.\n  Formulae from https://www.easyrgb.com/en/math.php\n*/\n\nimport {\n  type CmykObject,\n  type ColorObjType,\n  type HslObject,\n  type HsvObject,\n  type LabObject,\n  type LchObject,\n  type RgbObject,\n  type XyzObject,\n} from \"../types\";\nimport { convertDecimalToHex, expandHex, labDeltaE } from \"./utilities\";\n\nconst referenceWhiteConstants = {\n  x: 95.047,\n  y: 100,\n  z: 108.883,\n};\n\n/*\n   RGB / RGBA conversions\n*/\n\nexport function toRgbBase(colorObj: ColorObjType): RgbObject {\n  if (colorObj.format === \"rgb\" || colorObj.format === \"rgba\") {\n    return rgbToNormalizedRgb(colorObj.value as RgbObject);\n  }\n  if (colorObj.format === \"name\" && typeof colorObj.value === \"string\") {\n    return hexToNormalizedRgb(colorObj.value);\n  }\n  if (colorObj.format === \"hex\" && typeof colorObj.value === \"string\") {\n    return rgbToNormalizedRgb(hexToRgb(colorObj.value));\n  }\n  if (colorObj.format === \"hsl\") {\n    return hslToRgbNormalized(colorObj.value as HslObject);\n  }\n  if (colorObj.format === \"hsv\") {\n    return hsvToRgbNormalized(colorObj.value as HsvObject);\n  }\n  if (colorObj.format === \"lch\") {\n    const lab = lchToLab(colorObj.value as LchObject);\n    const xyz = labToXyz(lab);\n    return xyzToRgbNormalized(xyz);\n  }\n  if (colorObj.format === \"oklch\") {\n    const oklab = lchToLab(colorObj.value as LchObject);\n    const lRGB = okLabToLinearRbg(oklab);\n    return lRgbToNormalizedRgb(lRGB);\n  }\n\n  return {\n    r: undefined,\n    g: undefined,\n    b: undefined,\n    a: undefined,\n  };\n}\n\nexport function hexToNormalizedRgb(hexColor: string): RgbObject {\n  const rgb = hexToRgb(hexColor);\n  return rgbToNormalizedRgb(rgb);\n}\n\nexport function rgbNormalizedToRgb(rgb: RgbObject): RgbObject {\n  return {\n    r: rgb.r !== undefined ? Math.round(rgb.r * 255) : undefined,\n    g: rgb.g !== undefined ? Math.round(rgb.g * 255) : undefined,\n    b: rgb.b !== undefined ? Math.round(rgb.b * 255) : undefined,\n    a: rgb.a ?? undefined,\n  };\n}\n\nexport function rgbNormalizedToRgbPercent(rgb: RgbObject): RgbObject {\n  return {\n    r: rgb.r !== undefined ? Math.round(rgb.r * 100) : undefined,\n    g: rgb.g !== undefined ? Math.round(rgb.g * 100) : undefined,\n    b: rgb.b !== undefined ? Math.round(rgb.b * 100) : undefined,\n    a: rgb.a ?? undefined,\n  };\n}\n\nexport function rgbToNormalizedRgb(rgb: RgbObject): RgbObject {\n  const { r, g, b, a } = rgb;\n  return {\n    r: r !== undefined ? r / 255 : undefined,\n    g: g !== undefined ? g / 255 : undefined,\n    b: b !== undefined ? b / 255 : undefined,\n    a: a ?? undefined,\n  };\n}\n\nexport function lrgbToRgb(lrgb: RgbObject): RgbObject {\n  if (lrgb.r === undefined || lrgb.g === undefined || lrgb.b === undefined) {\n    throw new Error(\"RGB values must be defined\");\n  }\n\n  const fn = (c = 0): number => {\n    const abs = Math.abs(c);\n    return abs > 0.0031308\n      ? 1.055 * Math.pow(abs, 1 / 2.4) - 0.055\n      : 12.92 * abs;\n  };\n\n  return {\n    r: fn(lrgb.r),\n    g: fn(lrgb.g),\n    b: fn(lrgb.b),\n    a: lrgb.a ?? undefined,\n  };\n}\n\n/*\n  Hex / Hex8 conversions\n*/\n\nexport function rgbToHex(rgb: RgbObject): string | undefined {\n  if (rgb.r === undefined || rgb.g === undefined || rgb.b === undefined) {\n    return undefined;\n  }\n  const binaryRgb = (rgb.r << 16) | (rgb.g << 8) | rgb.b;\n  return binaryRgb.toString(16).padStart(6, \"0\");\n}\n\nexport function rgbaToHex8(rgba: RgbObject): string {\n  const binaryRgb = rgbToHex(rgba);\n  if (binaryRgb === undefined) {\n    return \"\";\n  }\n  const aHex = convertDecimalToHex(rgba.a ?? 1);\n  return `${binaryRgb.padStart(6, \"0\")}${aHex === \"0\" ? \"00\" : aHex}`;\n}\n\n/*\n    HSL / HSV conversions\n*/\n\nexport function rgbNormalizedToHsl(rgb: RgbObject): HslObject {\n  if (rgb.r === undefined || rgb.g === undefined || rgb.b === undefined) {\n    throw new Error(\"RGB values must be defined\");\n  }\n\n  const max = Math.max(rgb.r, rgb.g, rgb.b);\n  const min = Math.min(rgb.r, rgb.g, rgb.b);\n\n  let h = (max + min) / 2;\n  let s;\n  const l = (max + min) / 2;\n\n  if (max === min) {\n    h = 0;\n    s = 0; // Achromatic\n  } else {\n    const diff = max - min;\n    s = l > 0.5 ? diff / (2 - max - min) : diff / (max + min);\n\n    switch (max) {\n      case rgb.r:\n        h = (rgb.g - rgb.b) / diff + (rgb.g < rgb.b ? 6 : 0);\n        break;\n      case rgb.g:\n        h = (rgb.b - rgb.r) / diff + 2;\n        break;\n      case rgb.b:\n        h = (rgb.r - rgb.g) / diff + 4;\n        break;\n      default:\n        break;\n    }\n\n    h /= 6;\n  }\n\n  return {\n    h: Math.round(h * 360),\n    s: Math.round(s * 100),\n    l: Math.round(l * 100),\n  };\n}\n\nexport function rgbNormalizedToHsv(rgb: RgbObject): HsvObject {\n  if (rgb.r === undefined || rgb.g === undefined || rgb.b === undefined) {\n    throw new Error(\"RGB values must be defined\");\n  }\n\n  const max = Math.max(rgb.r, rgb.g, rgb.b);\n  const min = Math.min(rgb.r, rgb.g, rgb.b);\n\n  let h = max;\n  let s = max;\n  const v = max;\n\n  const diff = max - min;\n  const diffc = (c: number): number => (max - c) / 6 / diff + 1 / 2;\n\n  if (diff === 0) {\n    h = 0;\n    s = 0;\n  } else {\n    s = diff / max;\n    const rr = diffc(rgb.r);\n    const gg = diffc(rgb.g);\n    const bb = diffc(rgb.b);\n\n    if (rgb.r === max) {\n      h = rgb.b - rgb.g;\n    } else if (rgb.g === max) {\n      h = 1 / 3 + rr - bb;\n    } else if (rgb.b === max) {\n      h = 2 / 3 + gg - rr;\n    }\n\n    if (h < 0) {\n      h += 1;\n    } else if (h > 1) {\n      h -= 1;\n    }\n  }\n\n  return {\n    h: Math.round(h * 360),\n    s: Math.round(s * 100),\n    v: Math.round(v * 100),\n  };\n}\n\nexport function hslToRgbNormalized(hsl: HslObject): RgbObject {\n  function hue2rgb(p: number, q: number, t: number): number {\n    if (t < 0) {\n      t += 1;\n    }\n\n    if (t > 1) {\n      t -= 1;\n    }\n\n    if (t < 1 / 6) {\n      return p + (q - p) * 6 * t;\n    }\n\n    if (t < 1 / 2) {\n      return q;\n    }\n\n    if (t < 2 / 3) {\n      return p + (q - p) * (2 / 3 - t) * 6;\n    }\n\n    return p;\n  }\n\n  const h = (hsl.h ?? 0) / 360;\n  const s = (hsl.s ?? 0) / 100;\n  const l = (hsl.l ?? 0) / 100;\n\n  let r;\n  let g;\n  let b;\n\n  if (s === 0) {\n    r = g = b = l; // Achromatic\n  } else {\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n\n  return { r, g, b };\n}\n\nexport function hsvToRgbNormalized(hsv: HsvObject): RgbObject {\n  const h = ((hsv.h ?? 0) / 360) * 6;\n  const s = (hsv.s ?? 0) / 100;\n  const v = (hsv.v ?? 0) / 100;\n\n  const i = Math.floor(h);\n  const f = h - i;\n  const p = v * (1 - s);\n  const q = v * (1 - f * s);\n  const t = v * (1 - (1 - f) * s);\n\n  const mod = i % 6;\n\n  const r = [v, q, p, p, t, v][mod];\n  const g = [t, v, v, q, p, p][mod];\n  const b = [p, p, t, v, v, q][mod];\n  return { r, g, b };\n}\n\nexport function hexToRgb(hexColor: string): RgbObject {\n  const hex = expandHex(hexColor);\n  const rgb = parseInt(hex.replace(\"#\", \"\"), 16);\n  return {\n    r: (rgb >> 16) & 0xff,\n    g: (rgb >> 8) & 0xff,\n    b: rgb & 0xff,\n  };\n}\n\n/*\n  CMY / CMYK conversions\n*/\n\nexport function rgbNormalizedToCmy(rgb: RgbObject): CmykObject {\n  if (rgb.r === undefined || rgb.g === undefined || rgb.b === undefined) {\n    throw new Error(\"RGB values must be defined\");\n  }\n\n  return {\n    c: 1 - rgb.r,\n    m: 1 - rgb.g,\n    y: 1 - rgb.b,\n  };\n}\n\nexport function cmyToCmyk(cmy: CmykObject): CmykObject {\n  if (cmy.c === undefined || cmy.m === undefined || cmy.y === undefined) {\n    throw new Error(\"CMY values must be defined\");\n  }\n\n  let k: number = 1;\n  if (cmy.c < k) k = cmy.c;\n  if (cmy.m < k) k = cmy.m;\n  if (cmy.y < k) k = cmy.y;\n  if (k === 1) return { c: 0, m: 0, y: 0, k: 1 };\n  return {\n    c: (cmy.c - k) / (1 - k),\n    m: (cmy.m - k) / (1 - k),\n    y: (cmy.y - k) / (1 - k),\n    k,\n  };\n}\n\n/*\n  XYZ, CIE-L*ab, CIE-L*Ch(ab) conversions\n\n  X, Y and Z output refers to a D65/2° standard illuminant.\n\n  Reference white constants are based on the standard illuminant D65:\n  https://en.wikipedia.org/wiki/Illuminant_D65\n\n  The following is a list of reference white points for various standard illuminants:\n  https://en.wikipedia.org/wiki/Standard_illuminant#White_points_of_standard_illuminants\n\n  Pass in a custom reference white point if you want to use a different one, e.g.:\n  { x: 95.047, y: 100, z: 108.883 } for D65\n  { x: 96.422, y: 100, z: 82.521 } for D50\n  { x: 100, y: 100, z: 100 } for E\n*/\n\n// TODO deprecate XYZ, use modern conversions of lRGB instead\n\nexport function xyzToLab(xyz: XyzObject): LabObject {\n  let { x, y, z } = xyz;\n\n  if (x === undefined || y === undefined || z === undefined) {\n    throw new Error(\"XYZ values must be defined\");\n  }\n\n  x /= 95.047;\n  y /= 100;\n  z /= 108.883;\n\n  x = x > 0.008856 ? Math.pow(x, 1 / 3) : 7.787 * x + 16 / 116;\n  y = y > 0.008856 ? Math.pow(y, 1 / 3) : 7.787 * y + 16 / 116;\n  z = z > 0.008856 ? Math.pow(z, 1 / 3) : 7.787 * z + 16 / 116;\n\n  return {\n    l: 116 * y - 16,\n    a: 500 * (x - y),\n    b: 200 * (y - z),\n  };\n}\n\nexport function labToLch(lab: LabObject): LchObject {\n  if (lab.l === undefined || lab.a === undefined || lab.b === undefined) {\n    throw new Error(\"LAB values must be defined\");\n  }\n\n  let h = Math.atan2(lab.b, lab.a);\n  h > 0 ? (h = (h / Math.PI) * 180) : (h = 360 - (Math.abs(h) / Math.PI) * 180);\n\n  return {\n    l: lab.l,\n    c: Math.sqrt(lab.a * lab.a + lab.b * lab.b),\n    h,\n  };\n}\n\nexport function lchToLab(lch: LchObject): LabObject {\n  if (lch.l === undefined || lch.c === undefined || lch.h === undefined) {\n    throw new Error(\"LCH values must be defined\");\n  }\n\n  const hr = (lch.h * Math.PI) / 180;\n\n  return {\n    l: lch.l,\n    a: Math.cos(hr) * lch.c,\n    b: Math.sin(hr) * lch.c,\n  };\n}\n\nexport function labToXyz(\n  lab: LabObject,\n  referenceWhite: Record<string, number> = referenceWhiteConstants,\n): XyzObject {\n  if (lab.l === undefined || lab.a === undefined || lab.b === undefined) {\n    throw new Error(\"LAB values must be defined\");\n  }\n\n  let y = (lab.l + 16) / 116;\n  let x = lab.a / 500 + y;\n  let z = y - lab.b / 200;\n\n  const y2 = Math.pow(y, 3);\n  const x2 = Math.pow(x, 3);\n  const z2 = Math.pow(z, 3);\n\n  y = y2 > 0.008856 ? y2 : (y - 16 / 116) / 7.787;\n  x = x2 > 0.008856 ? x2 : (x - 16 / 116) / 7.787;\n  z = z2 > 0.008856 ? z2 : (z - 16 / 116) / 7.787;\n\n  return {\n    x: x * referenceWhite.x,\n    y: y * referenceWhite.y,\n    z: z * referenceWhite.z,\n  };\n}\n\nexport function xyzToRgbNormalized(xyz: XyzObject): RgbObject {\n  if (xyz.x === undefined || xyz.y === undefined || xyz.z === undefined) {\n    return {\n      r: undefined,\n      g: undefined,\n      b: undefined,\n    };\n  }\n  let { x, y, z } = xyz;\n  x /= 100;\n  y /= 100;\n  z /= 100;\n\n  const r = x * 3.2406 + y * -1.5372 + z * -0.4986;\n  const g = x * -0.9689 + y * 1.8758 + z * 0.0415;\n  const b = x * 0.0557 + y * -0.204 + z * 1.057;\n\n  return {\n    r: r > 0.0031308 ? 1.055 * Math.pow(r, 1 / 2.4) - 0.055 : r * 12.92,\n    g: g > 0.0031308 ? 1.055 * Math.pow(g, 1 / 2.4) - 0.055 : g * 12.92,\n    b: b > 0.0031308 ? 1.055 * Math.pow(b, 1 / 2.4) - 0.055 : b * 12.92,\n  };\n}\n\nexport function rgbToXyz(rgb: RgbObject): XyzObject {\n  let { r, g, b } = rgb;\n\n  if (r === undefined || g === undefined || b === undefined) {\n    throw new Error(\"RGB values must be defined\");\n  }\n\n  r = r > 0.04045 ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92;\n  g = g > 0.04045 ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92;\n  b = b > 0.04045 ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92;\n\n  r *= 100;\n  g *= 100;\n  b *= 100;\n\n  return {\n    x: r * 0.4124 + g * 0.3576 + b * 0.1805,\n    y: r * 0.2126 + g * 0.7152 + b * 0.0722,\n    z: r * 0.0193 + g * 0.1192 + b * 0.9505,\n  };\n}\n\n/*\n  OKLAB <- -> XYZ conversions\n  Formula from https://bottosson.github.io/posts/oklab/\n\n  OKLAB uses a D65/10° standard illuminant.\n\n  OKLCH uses the same conversion as LCH, but with the OKLAB color space.\n*/\n\nconst M1 = [\n  [0.8189330101, 0.3618667424, -0.1288597137],\n  [0.0329845436, 0.9293118715, 0.0361456387],\n  [0.0482003018, 0.2643662691, 0.633851707],\n];\n\nconst M2 = [\n  [0.2104542553, 0.793617785, -0.0040720468],\n  [1.9779984951, -2.428592205, 0.4505937099],\n  [0.0259040371, 0.7827717662, -0.808675766],\n];\n\nconst invM1 = [\n  [1.2270138511035211, -0.5577999806518222, 0.28125614896646783],\n  [-0.04058017842328059, 1.1122568696168302, -0.07167667866560119],\n  [-0.0763812845057069, -0.4214819784180127, 1.586163220440795],\n];\n\nconst invM2 = [\n  [0.9999999984505199, 0.3963377921737679, 0.21580375806075883],\n  [1.0000000088817609, -0.10556134232365635, -0.0638541747717059],\n  [1.000000054672411, -0.08948418209496577, -1.291485537864092],\n];\n\nexport function xyzToOklab(xyz: XyzObject): LabObject {\n  if (xyz.x === undefined || xyz.y === undefined || xyz.z === undefined) {\n    throw new Error(\"XYZ values must be defined\");\n  }\n\n  const L = Math.cbrt(xyz.x * M1[0][0] + xyz.y * M1[0][1] + xyz.z * M1[0][2]);\n  const M = Math.cbrt(xyz.x * M1[1][0] + xyz.y * M1[1][1] + xyz.z * M1[1][2]);\n  const S = Math.cbrt(xyz.x * M1[2][0] + xyz.y * M1[2][1] + xyz.z * M1[2][2]);\n\n  return {\n    l: M2[0][0] * L + M2[0][1] * M + M2[0][2] * S,\n    a: M2[1][0] * L + M2[1][1] * M + M2[1][2] * S,\n    b: M2[2][0] * L + M2[2][1] * M + M2[2][2] * S,\n  };\n}\n\n// TODO giving largely inflated numbers\nexport function okLabToXyz(oklab: LabObject): XyzObject {\n  if (oklab.l === undefined || oklab.a === undefined || oklab.b === undefined) {\n    throw new Error(\"OKLAB values must be defined\");\n  }\n\n  const L = Math.pow(\n    oklab.l * invM2[0][0] + oklab.a * invM2[0][1] + oklab.b * invM2[0][2],\n    3,\n  );\n  const M = Math.pow(\n    oklab.l * invM2[1][0] + oklab.a * invM2[1][1] + oklab.b * invM2[1][2],\n    3,\n  );\n  const S = Math.pow(\n    oklab.l * invM2[2][0] + oklab.a * invM2[2][1] + oklab.b * invM2[2][2],\n    3,\n  );\n\n  return {\n    x: L * invM1[0][0] + M * invM1[0][1] + S * invM1[0][2],\n    y: L * invM1[1][0] + M * invM1[1][1] + S * invM1[1][2],\n    z: L * invM1[2][0] + M * invM1[2][1] + S * invM1[2][2],\n  };\n}\n\nexport function okLabToLinearRbg(oklab: LabObject): RgbObject {\n  let L = oklab.l / 100 + 0.3963377774 * oklab.a + 0.2158037573 * oklab.b;\n  let M = oklab.l / 100 - 0.1055613458 * oklab.a - 0.0638541728 * oklab.b;\n  let S = oklab.l / 100 - 0.0894841775 * oklab.a - 1.291485548 * oklab.b;\n\n  L = L * L * L;\n  M = M * M * M;\n  S = S * S * S;\n\n  return {\n    r: 4.0767416621 * L - 3.3077115913 * M + 0.2309699292 * S,\n    g: -1.2684380046 * L + 2.6097574011 * M - 0.3413193965 * S,\n    b: -0.0041960863 * L - 0.7034186147 * M + 1.707614701 * S,\n  };\n}\n\nexport function lRgbToNormalizedRgb(lRgb: RgbObject): RgbObject {\n  const fn = (c = 0): number => {\n    const abs = Math.abs(c);\n    return abs > 0.0031308\n      ? 1.055 * Math.pow(abs, 1 / 2.4) - 0.055\n      : 12.92 * abs;\n  };\n\n  return {\n    r: fn(lRgb.r),\n    g: fn(lRgb.g),\n    b: fn(lRgb.b),\n  };\n}\n\n/*\n  Other conversions\n*/\nexport function findClosestColor(\n  rgb: RgbObject,\n  namedColorsRgb: Record<string, RgbObject>,\n): string {\n  let minDistance = Infinity;\n  let closestColor = \"\";\n  const lab1 = xyzToLab(rgbToXyz(rgb));\n  for (const color in namedColorsRgb) {\n    const lab2 = xyzToLab(rgbToXyz(namedColorsRgb[color]));\n    const distance = labDeltaE(lab1, lab2);\n    if (distance < minDistance) {\n      closestColor = color;\n      minDistance = distance;\n    }\n  }\n  return closestColor;\n}\n"],"mappings":"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"}